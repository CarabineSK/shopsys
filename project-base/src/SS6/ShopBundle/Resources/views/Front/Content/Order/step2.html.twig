{% extends '@SS6Shop/Front/Content/Order/step.html.twig' %}

{% block h1 %}
	{{ 'Objednávka'|trans }}
{% endblock %}

{% block content %}

	<div class="box-transport-payment">

		<div id="transportAndPayment" class="box-transport-payment__choose">

			<div class="box-transport-payment__choose__item">

				<h2>{{ 'Výběr dopravy'|trans }}</h2>

				<div class="box-chooser js-form-group">
					{{ form_errors(form.transport, { errors_attr: {class: 'form-error--inline'} }) }}

					<div id="transportAndPayment_transport">
						{% for child in form.transport %}
							{% set choice = form.transport.vars.choices[child.vars.name] %}
							{% set transportPrice = transportsPrices[choice.data.id] %}
							<label class="box-chooser__item">
								<span class="box-chooser__item__check">
									{{ form_widget(child, { attr: { class: 'transport', 'data-id': choice.data.id} }) }}
								</span>

								<span class="box-chooser__item__image">
									{% if imageExists(choice.data) %}
										{{ image(choice.data) }}
									{% endif %}
								</span>

								<span class="box-chooser__item__title">
									<strong class="box-chooser__item__title__name">
										{{ choice.data.name }}
									</strong>
									{% if choice.data.description %}
										<span class="box-chooser__item__title__description">
											- {{ choice.data.description }}
										</span>
									{% endif %}
								</span>

								<span class="box-chooser__item__price">
									{{ transportPrice.priceWithVat|priceText }}
								</span>
							</label>
						{% else %}
							{% do form.transport.setRendered %}
							{{ 'Není z čeho vybírat'|trans }}
						{% endfor %}
					</div>
				</div>
			</div>

			<div class="box-transport-payment__choose__item">

				<h2>{{ 'Výběr platby'|trans }}</h2>

				<div class="box-chooser box-chooser--smaller js-form-group">
					{{ form_errors(form.payment, { errors_attr: {class: 'form-error--inline'} }) }}

					<div id="transportAndPayment_payment">
						{% for child in form.payment %}
							{% set choice = form.payment.vars.choices[child.vars.name] %}
							{% set paymentPrice = paymentsPrices[choice.data.id] %}
							<label class="box-chooser__item">
								<span class="box-chooser__item__check">
									{{ form_widget(child, { attr: { class: 'payment', 'data-id': choice.data.id} }) }}
								</span>

								<span class="box-chooser__item__image">
									{% if imageExists(choice.data) %}
										{{ image(choice.data) }}
									{% endif %}
								</span>

								<span class="box-chooser__item__title">
									<strong class="box-chooser__title__name">
										{{ choice.data.name }}
									</strong>
									{% if choice.data.description %}
										<span class="box-chooser__item__title__description">
											- {{ choice.data.description }}
										</span>
									{% endif %}
								</span>

								<span class="box-chooser__item__price">
									{{ paymentPrice.priceWithVat|priceText }}
								</span>
							</label>
						{% else %}
							{% do form.payment.setRendered %}
							{{ 'Není z čeho vybírat'|trans }}
						{% endfor %}
					</div>
				</div>
			</div>
		</div>

		<div class="box-transport-payment__info">
			{{ include('@SS6Shop/Front/Content/Order/preview.html.twig') }}
		</div>
	</div>

	<div class="in-action">
		<div class="in-action__right">
			{{ form_widget(form.save, { label: 'Pokračovat v objednávce'|trans, attr: { class: 'btn btn--primary in-action__btn in-action__btn--big' } }) }}
		</div>

		<div class="in-action__left">
			<button type="submit" name="{{ flow.getFormTransitionKey() }}" value="back" class="btn in-action__btn js-no-validate-button">
				{{ 'Zpět do košíku'|trans }}
			</button>
		</div>
	</div>
{% endblock %}