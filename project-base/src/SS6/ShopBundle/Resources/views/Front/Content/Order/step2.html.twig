{% extends '@SS6Shop/Front/Content/Order/step.html.twig' %}

{% block h1 %}
	Objednávka
{% endblock %}

{% block content %}

	<div class="row">

		<div class="col-sm-12 col-md-8">

			<div class="info-box">

				<h2 class="mt-0">Výběr dopravy</h2>

				<div class="chooser">
					{{ form_errors(form.transport, { attr: {class: 'message-floating--on-top'} }) }}

					{% for child in form.transport %}
						{% set choice = form.transport.vars.choices[child.vars.name] %}
						{% set transportPrice = transportsPrices[choice.data.id] %}
						<label class="chooser__item">
							<span class="chooser__check">
								{{ form_widget(child, { attr: { class: 'transport', 'data-id': choice.data.id} }) }}
							</span>

							<span class="chooser__image">
								{% if imageExists(choice.data) %}
									{{ image(choice.data, { height: '20px' }) }}
								{% else %}
									<img src="{{ asset('assets/frontend/images/bez.jpg') }}" alt="" width="40px" height="20px">
								{% endif %}
							</span>

							<span class="chooser__title">
								<strong>
									{{ choice.data.name }}
								</strong>
								{% if choice.data.description %}
									<span class="chooser__description">
										- {{ choice.data.description }}
									</span>
								{% endif %}
							</span>

							<span class="chooser__price price-main">
								{{ transportPrice.basePriceWithVat|price }}
							</span>
						</label>
					{% else %}
						{% do form.transport.setRendered %}
						Není z čeho vybírat
					{% endfor %}
				</div>

			</div>

			<div class="info-box">

				<h2 class="mt-0">Výběr platby</h2>

				<div class="chooser chooser--smaller">
					{{ form_errors(form.payment, { attr: {class: 'message-floating--on-top'} }) }}

					{% for child in form.payment %}
						{% set choice = form.payment.vars.choices[child.vars.name] %}
						{% set paymentPrice = paymentsPrices[choice.data.id] %}
						<label class="chooser__item">
							<span class="chooser__check">
								{{ form_widget(child, { attr: { class: 'payment', 'data-id': choice.data.id} }) }}
							</span>

							<span class="chooser__image">
								{% if imageExists(choice.data) %}
									{{ image(choice.data, { height: '20px' }) }}
								{% else %}
									<img src="{{ asset('assets/frontend/images/bez.jpg') }}" alt="" width="40px" height="20px">
								{% endif %}
							</span>

							<span class="chooser__title">
								<strong>
									{{ choice.data.name }}
								</strong>
								{% if choice.data.description %}
									<span class="chooser__description">
										- {{ choice.data.description }}
									</span>
								{% endif %}
							</span>

							<span class="chooser__price price-main">
								{{ paymentPrice.basePriceWithVat|price }}
							</span>
						</label>
					{% else %}
						{% do form.payment.setRendered %}
						Není z čeho vybírat
					{% endfor %}
				</div>

			</div>
		</div>

		{{ include('@SS6Shop/Front/Content/Order/preview.html.twig') }}

	</div>



	<div class="buttons-control">
		{{ form_widget(form.save, { label: 'Pokračovat v objednávce', attr: { class: 'button button--large button-primary buttons-control__right' } }) }}

		<button type="submit" name="{{ flow.getFormTransitionKey() }}" value="back" class="button button--alter buttons-control__left">
			Zpět do košíku
		</button>
	</div>
{% endblock %}