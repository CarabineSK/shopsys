{% extends '@SS6Shop/Admin/Layout/layoutWithPanel.html.twig' %}

{% block title %}- {{ 'Karta zboží'|trans }}{% endblock %}
{% block h1 %}{% endblock %}

{% block header %}
	<header class="web__header">
		<div class="web__header__in web__header__in--small">
			<div class="top-info">
				<div class="top-info__logo">
					<span class="sprite sprite-logo"></span>
				</div>
				<div class="top-info__text">
					<h1 class="top-info__text__title">{% block product_header_heading %}{% endblock %}</h1>
				</div>
			</div>
		</div>
	</header>
{% endblock %}

{% block menu_panel %}
	<div class="panel">
		<ul class="anchor-menu js-product-detail-navigation"></ul>
	</div>
	{% block menu_panel_visibilities %}{% endblock %}
{% endblock %}

{% block breadcrumb %}{% endblock %}

{% block main_content %}

	{{ form_start(form) }}
		<div id="product_edit_form_productData"></div>
		{{ form_errors(form) }}

		<div class="wrap-border wrap-border--small">
			<div class="form-full">
				<div class="form-full__title">
					<div class="form-full__title__in">{{ 'Název'|trans }}</div>
					<div class="form-full__title__buttons"></div>
				</div>
				{% for locale, formName in form.productData.name %}
					<div class="form-full__field">
						<div class="input__wrap">
							{{ form_widget(formName, { attr: { class: 'input--flag form-full__field__input'} }) }}
							<span class="input__flag">
								{{ localeFlag(locale) }}
							</span>
						</div>
						{{ form_errors(formName) }}
					</div>
				{% endfor %}
			</div>
		</div>

		{% block product_variants %}{% endblock %}

		<div class="form-group wrap-border">

			<div class="form-group__title">
				{{ 'Základní nastavení'|trans }}
			</div>

			{% block product_catnum %}
				{{ form_row(form.productData.catnum, { label: 'Katalogové číslo'|trans }) }}
			{% endblock %}

			{% block product_partno %}
				{{ form_row(form.productData.partno, { label: 'PartNo (výrobní číslo)'|trans }) }}
			{% endblock %}

			{% block product_ean %}
				{{ form_row(form.productData.ean, { label: 'EAN'|trans }) }}
			{% endblock %}

			{{ form_id(product|default(null)) }}

			{{ form_row(form.productData.flags, { label: 'Příznaky'|trans}) }}

			{{ form_row(form.productData.brand, { label: 'Značka'|trans}) }}

		</div>

		<div class="form-group wrap-border">

			<div class="form-group__title">
				{{ 'Zobrazení a dostupnost'|trans }}
			</div>

			{{ form_row(form.productData.hidden, { label: 'Skrýt zboží'|trans }) }}

			{% block product_calculated_hidden_info %}{% endblock %}

			{{ form_row(form.productData.sellingFrom, { label: 'Datum vložení'|trans }) }}

			{{ form_row(form.productData.sellingTo, { label: 'Datum stažení'|trans }) }}

			{{ form_row(form.productData.sellingDenied, { label: 'Vyřadit z prodeje'|trans,
				icon: {
					title: 'Zboží vyřazené z prodeje se nezobrazuje ve výpisech ani nelze vyhledat. Detail tohoto zboží je dostupný přímým přístupem z URL, zboží ale nelze vložit do košíku.'|trans
				} }) }}

			{% block product_calculated_selling_denied_info %}{% endblock %}

			{% block product_main_categories %}{% endblock %}

			{% block product_categories %}
				<div class="form-line">
					{{ form_label(form.productData.categoriesByDomainId, 'Přiřazení do kategorie'|trans) }}
					<div class="form-line__line">
						{% for domainId, categoriesForm in form.productData.categoriesByDomainId %}
							<div class="form-line__box">
								<div class="form-line__group form-line__box__title">
									<span class="form-line__group__image">
										<span class="in-image in-image--large">
											<span class="in-image__in in-image__in--{{ domainId }}" title="{{ getDomainName(domainId) }}">{{ domainId }}</span>
										</span>
									</span>
									<strong class="form-line__group__name">{{ getDomainName(domainId) }}</strong>
								</div>
								<div class="form-line__box__content">
									{{ form_widget(categoriesForm) }}
									{{ form_errors(categoriesForm) }}
								</div>
							</div>
						{% endfor %}
					</div>
				</div>
			{% endblock %}

			{{ form_row(form.productData.unit, { label: 'Jednotka'|trans }) }}

			{% block product_stock_and_availability %}
				{{ form_row(form.productData.usingStock, { label: 'Používat skladové zásoby'|trans }) }}
				<div class="js-product-using-stock form-line__js">
					{{ form_row(form.productData.stockQuantity, { label: 'Skladem'|trans }) }}
					{{ form_row(form.productData.outOfStockAction, { label: 'Akce při vyprodání'|trans }) }}
					<div class="js-product-using-stock-and-alternate-availability">
						{{ form_row(form.productData.outOfStockAvailability, { label: 'Dostupnost při vyprodání'|trans }) }}
					</div>
				</div>
				<div class="js-product-not-using-stock form-line__js">
					{{ form_row(form.productData.availability, { label: 'Dostupnost'|trans }) }}
				</div>
			{% endblock %}

		</div>

		<div class="form-group wrap-border">

			<div class="form-group__title">
				{{ 'Ceny'|trans }}
			</div>

			{% block product_pricing %}
				{{ form_row(form.productData.priceCalculationType, { label: 'Výpočet prodejních cen'|trans }) }}
				{{ form_row(form.productData.vat, { label: 'DPH'|trans }) }}

				{% block product_calculated_prices %}{% endblock %}
			{% endblock %}

		</div>

		<div class="form-group wrap-border">
			{% block product_description %}
				<div class="form-group__title">
					{{ 'Popis'|trans }}
				</div>

				{% for domainId, descriptionForm in form.descriptions %}
					<div class="form-line form-line--no-padd">
						<div class="form-line__group">
							<span class="form-line__group__image">
								{{ domainIcon(domainId, 'large') }}
							</span>
							<strong class="form-line__group__name">{{ getDomainName(domainId) }}</strong>
						</div>
					</div>
					<div class="form-line">
						<div class="form-line__line form-line__line--no-space">
							{{ form_widget(descriptionForm) }}
						</div>
					</div>

				{% endfor %}
			{% endblock %}
		</div>

		<div class="js-form-group wrap-border form-group">
			<div class="form-group__title">
				<span class="js-validation-label">{{ 'Parametry'|trans }}</span>

				{{ form_errors(form.parameters) }}
			</div>
			<table class="table-form" id="product_edit_form_parameters">
				<thead>
					<tr class="table-form__row">
						<th class="table-form__cell table-form__cell--del-before table-form__cell--label">{{ 'Parametr'|trans }}</th>
						<th class="table-form__cell table-form__cell--del"></th>
						<th class="table-form__cell table-form__cell--del-after">{{ 'Hodnota'|trans }}</th>
						<th class="table-form__cell"></th>
					</tr>
				</thead>
				<tbody class="js-parameters" data-prototype="{{ _self.parameterRow(form.parameters.vars.prototype)|escape }}" data-index="{{ form.parameters|length }}">
					{% macro parameterRow(parameter, index) %}
						<tr class="js-parameters-item js-form-group table-form__row" data-index="{{ index }}">
							<td class="table-form__cell table-form__cell--del-before">
								{{ form_widget(parameter.parameter, { isSimple: true} ) }}
							</td>
							<td class="table-form__cell table-form__cell--del">
								<span class="svg svg-arrow-right"></span>
							</td>
							<td class="table-form__cell  table-form__cell--del-after">
								{% for locale, valueTextLocaleForm in parameter.valueText %}
									<div class="input__wrap">
										{{ form_widget(valueTextLocaleForm, { attr: { class: 'input--flag'} })  }}
										<span class="input__flag">
											{{ localeFlag(locale) }}
										</span>
										{{ form_errors(valueTextLocaleForm) }}
									</div>
								{% endfor %}
							</td>
							<td class="table-form__cell text-right">
								<a href="#" class="js-parameters-item-remove table-form__action"><i class="svg svg-circle-cross"></i></a>
							</td>
						</tr>
					{% endmacro %}

					{% for key, parameter in form.parameters %}
						{{ _self.parameterRow(parameter, key) }}
					{% else %}
						{% do form.parameters.setRendered %}
					{% endfor %}

					<tr class="js-parameters-empty-item table-form__row">
						<td class="table-form__cell" colspan="4">{{ 'Přidejte nějaké parametry'|trans }}</td>
					</tr>
				</tbody>
			</table>

			<div class="form-line form-line--no-top-border">
				<div class="form-line__line form-line__line--no-space">
					<a href="#" class="js-parameters-item-add btn btn-primary"><i class="btn__icon sprite sprite-plus"></i> {{ 'Přidat další parametr'|trans }}</a>
				</div>
			</div>
		</div>

		<div class="form-group wrap-border">
			<div class="form-group__title">
				{{ 'SEO'|trans }}
			</div>
			<div class="form-line">
				<strong class="form-line__label">
					{{ 'Titulek'|trans }}
				</strong>
				{% for domainId, seoTitleForm in form.seoTitles %}
					<div class="form-line__side {% if not loop.first %}mt5{% endif %} js-characters-counter">
						<div class="form-line__item form-line__item--left">
							<div class="input__wrap">
								{{ form_widget(seoTitleForm, { multidomain: true, domainId: domainId, attr: { class: 'js-characters-counter-input input--domain' } }) }}
								<span class="input__domain">
									{{ domainIcon(domainId) }}
								</span>
							</div>
						</div>

						<div class="form-line__count">
							<span class="form-line__count__desc js-characters-counter-info" data-recommended-length="60">
							</span>
						</div>
						{{ form_errors(seoTitleForm) }}
					</div>
				{% endfor %}
			</div>

			<div class="form-line">
				<strong class="form-line__label">
					{{ 'Meta description'|trans }}
				</strong>

				{% for domainId, seoMetaDescriptionForm in form.seoMetaDescriptions %}
					<div class="form-line__side {% if not loop.first %}mt5{% endif %} js-characters-counter">
						<div class="form-line__item form-line__item--left">
							<span class="input__wrap">
								{{ form_widget(seoMetaDescriptionForm, { multidomain: true, domainId: domainId, attr: { class: 'js-characters-counter-input input--domain' } }) }}
								<span class="input__domain">
									{{ domainIcon(domainId) }}
								</span>
							</span>
						</div>

						<div class="form-line__count">
							<div class="form-line__count__desc js-characters-counter-info" data-recommended-length="155"></div>
						</div>
					</div>
					{{ form_errors(seoMetaDescriptionForm) }}
				{% endfor %}
			</div>

			{% block product_urls %}{% endblock %}
		</div>

		<div class="form-group wrap-border">
			<div class="form-group__title">
				{{ 'Zbožové vyhledávače'|trans }}
			</div>
			<div class="form-line form-line--no-padd">
				<div class="form-line__group">
					<strong class="form-line__group__name">{{ 'Heureka.cz'|trans }}</strong>
				</div>
			</div>
			<div class="form-line">
				<div class="form-line__line form-line__line--no-space">
					{{ form_row(form.heurekaCpcValues, { label: 'Maximální částka za proklik'|trans }) }}
				</div>
			</div>
		</div>

		<div class="form-group wrap-border">
			<div class="form-group__title">
				{{ 'Obrázky'|trans }}
			</div>

			{% block images %}{% endblock %}

			{{ form_widget(form.imagesToUpload, { attr: { class: 'box-upload--bordered' }, infoText: 'Můžete nahrávat formáty: PNG, JPG a GIF'|trans }) }}
			{{ form_widget(form.imagesToDelete, { attr: { style: 'display: none;' } }) }}
		</div>

		{{ form_row(form.accessories, { label: 'Příslušenství'|trans }) }}

		{% embed '@SS6Shop/Admin/Inline/FixedBar/fixedBar.html.twig' %}
			{% block fixed_bar_content %}
				<button id="js-close-without-saving" type="button" class="btn-link-style">{{ 'Zavřít bez uložení'|trans }}</button>
				{{ form_save(product|default(null), form) }}
			{% endblock %}
		{% endembed %}

	{{ form_end(form) }}

{% endblock %}